<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="UTF-8">
    <title>サイト来訪問者アクセス履歴レポート</title>
    <meta name="author" content="株式会社アンシャンテ">
    <meta name="copyright" content="&copy; COPYRIGHT © 株式会社アンシャンテ ALL RIGHTS RESERVED.">
    <meta name="robots" content="all">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/personal_style.css">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
  </head>

  <body>
    <div id="index-contents" class="personal_style">
      <header>
        <div class="report_name">
          <p>サイト来訪者アクセス履歴レポート</p>
        </div>
      </header>
      <div id="contents_inner">
        <div class="title-contents">
          <div class="title_leftinner">
            <div class="title_name">
              <p>イースクラム&emsp;<span class="update_date">2020年02月21日現在</span></p>
            </div>
          </div>
          <div class="title_rightinner">
            <div class="btn-contents">
              <img src="image/refresh.svg" alt="アイコン"/><span><input type="button" id="button" value="最新情報に更新" onClick="window.location.reload();" /></span>
            </div>

          </div>
        </div>

        <div class="inner">
          <div id="tabManagement">
            <div id="personal_tab_one" class="tab clicked" onclick="return tabManageContents(this);">配信履歴</div>
            <div id="personal_tab_two" class="tab"  onclick="return tabManageContents(this);">よく閲覧する人</div>
            <div id="personal_tab_three" class="tab"  onclick="return tabManageContents(this);">よく閲覧されるページ</div>
          </div>

          <div id="tabInners">
            <div id="personal_tab_one_inner" class="tab_inner clicked">
              <div class="chart_container_left">
                <div class="subtitle-contents">
                  <div class="subtitle_leftinner">
                    <div class="subtitle_name">
                      <p>メルマガの配信履歴と個人の閲覧履歴</p>
                    </div>
                  </div>
                </div>
                <div class="context">
                  <div class="table-contents">
                    <div class="table-rightinner">
                      <div class="table">
                        <table>
                          <thead>
                            <tr>
                              <th>配信日<img src="image/sort.svg" alt="アイコン"/></th>
                              <th>タイトル<img src="image/sort.svg" alt="アイコン"/></th>
                              <th>配信数<img src="image/sort.svg" alt="アイコン"/></th>
                              <th>開封数<img src="image/sort.svg" alt="アイコン"/></th>
                              <th>クリック数<img src="image/sort.svg" alt="アイコン"/></th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td>2019/07/16</td>
                              <td class="long_text"><a class="openDetails">丁稚どんメルマガ2019年7月号</a></td>
                              <td>89</td>
                              <td>16</td>
                              <td>2</td>
                            </tr>
                            <tr>
                              <td>2019/11/15</td>
                              <td class="long_text"><a class="openDetails">新ものづくり展「ASPACクラウド生産管理」来場御礼メール</a></td>
                              <td>22</td>
                              <td>5</td>
                              <td>2</td>
                            </tr>
                            <tr>
                              <td>2019/07/16</td>
                              <td class="long_text"><a class="openDetails">本格的生産管理システムセミナーご案内！</a></td>
                              <td>89</td>
                              <td>16</td>
                              <td>2</td>
                            </tr>
                            <tr>
                              <td>2019/07/16</td>
                              <td class="long_text"><a class="openDetails">（再送）クラウドサービス利用率向上してます！</a></td>
                              <td>89</td>
                              <td>16</td>
                              <td>2</td>
                            </tr>
                            <tr>
                              <td>2019/07/16</td>
                              <td class="long_text"><a class="openDetails">丁稚どんメルマガ2019年7月号</a></td>
                              <td>89</td>
                              <td>16</td>
                              <td>2</td>
                            </tr>
                            <tr>
                              <td>2019/07/16</td>
                              <td class="long_text"><a class="openDetails">丁稚どんメルマガ2019年7月号</a></td>
                              <td>89</td>
                              <td>16</td>
                              <td>2</td>
                            </tr>
                          </tbody>
                        </table>
                        <div class="table_details">
                          <div class="numbers">
                            <p>1件〜10件</p>
                          </div>
                          <div class="pages" id="target_point">
                            <div>
                              <a>前へ&emsp;1&emsp;2&emsp;3&emsp;次へ</a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="msg-contents">
                    <div class="msg-topinner">
                      <div class="top-leftinner">
                        <p class="changeFontSize"><img src="image/point.svg" alt="アイコン"/><span><a class="underline">上記タイトル</a>をクリックすると詳細情報を確認できます</span></p>
                      </div>
                    </div>
                    <div class="msg-bottominner">
                      <div class="explanation_list">
                        <ul>
                          <div class="text-container1">
                            <div class="text-container1-left">
                              <p class="changeFontSize">（※1）</p>
                            </div>
                            <div class="text-container1-right">
                              <p class="changeFontSize">企業・団体名は固定IPアドレスにてアクセスされた場合のみ特定可能です。</p>
                            </div>
                          </div>

                          <div class="text-container1">
                            <div class="text-container1-left">
                              <p class="changeFontSize">（※2）</p>
                            </div>
                            <div class="text-container1-right">
                              <p class="changeFontSize">累計アクセス数とはサービス開始日より1年間の累計とし、2年目以降は逐次更新されます。</p>
                            </div>
                          </div>

                          <div class="text-container1">
                            <div class="text-container1-left">
                              <p class="changeFontSize">（※3）</p>
                            </div>
                            <div class="text-container1-right">
                              <p class="changeFontSize">直近アクセス数とはログイン当日のアクセス数であり、当該欄に「－」と表示されている企業は前日以前にアクセスしたことを示します。その詳細は企業名をクリックすることで確認できます。</p>
                            </div>
                          </div>

                          <div class="text-container1">
                          <div class="text-container1-left">
                            <p class="changeFontSize">（※4）</p>
                          </div>
                          <div class="text-container1-right">
                            <p class="changeFontSize">地域とはどこからアクセスしたかを示します。</p>
                          </div>
                        </div>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="chart_container_right">
                <div class="subtitle-contents">
                  <div class="subtitle_leftinner">
                    <div class="subtitle_name">
                      <p>メルマガの配信数と個人の閲覧履歴</p>
                    </div>
                  </div>
                </div>
                <div class="chart_container_right_inner">
                  <div class="line_chart_section">
                    <div class="chart_title">配信数</div>
                    <div class="chart_inner">
                      <div class="line_chart">
                        <canvas id="lineChart" width="100" height="100"></canvas>
                      </div>
                    </div>
                  </div>
                  <div class="pie_chart_section">
                    <div class="chart_title">開封率</div>
                    <div class="chart_inner">
                      <div class="pie_chart">
                        <canvas id="pieChart" width="100" height="100"></canvas>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div id="personal_tab_two_inner" class="tab_inner">
              <div class="chart_container_left">
                <div class="subtitle-contents">
                  <div class="subtitle_leftinner">
                    <div class="subtitle_name">
                      <p>今回の配信によるポイント上位者【トップ50】</p>
                    </div>
                  </div>
                </div>
                <div class="context">
                  <div class="table-contents">
                    <div class="table-rightinner">
                      <div class="table">
                        <table>
                          <thead>
                            <tr>
                              <th>会社名<img src="image/sort.svg" alt="アイコン"/></th>
                              <th>氏名<img src="image/sort.svg" alt="アイコン"/></th>
                              <th>ポイント数<img src="image/sort.svg" alt="アイコン"/></th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td class="long_text">太平化学産業株式会社</td>
                              <td class="long_text"><a class="openDetails">岡原　智也</a></td>
                              <td>29</td>
                            </tr>
                            <tr>
                              <td class="long_text">株式会社グロッツ・ベッケルト ジャパン</td>
                              <td class="long_text"><a class="openDetails">橋本　伸二郎</a></td>
                              <td>1</td>
                            </tr>
                            <tr>
                              <td class="long_text">太平化学産業株式会社</td>
                              <td class="long_text"><a class="openDetails">岡原　智也</a></td>
                              <td>29</td>
                            </tr>
                            <tr>
                              <td class="long_text">太平化学産業株式会社</td>
                              <td class="long_text"><a class="openDetails">岡原　智也</a></td>
                              <td>29</td>
                            </tr>
                            <tr>
                              <td class="long_text">太平化学産業株式会社</td>
                              <td class="long_text"><a class="openDetails">岡原　智也</a></td>
                              <td>29</td>
                            </tr>
                            <tr>
                              <td class="long_text">太平化学産業株式会社</td>
                              <td class="long_text"><a class="openDetails">岡原　智也</a></td>
                              <td>29</td>
                            </tr>
                            <tr>
                              <td class="long_text">太平化学産業株式会社</td>
                              <td class="long_text"><a class="openDetails">岡原　智也</a></td>
                              <td>29</td>
                            </tr>
                            <tr>
                              <td class="long_text">太平化学産業株式会社</td>
                              <td class="long_text"><a class="openDetails">岡原　智也</a></td>
                              <td>29</td>
                            </tr>
                            <tr>
                              <td class="long_text">太平化学産業株式会社</td>
                              <td class="long_text"><a class="openDetails">岡原　智也</a></td>
                              <td>29</td>
                            </tr>
                            <tr>
                              <td class="long_text">太平化学産業株式会社</td>
                              <td class="long_text"><a class="openDetails">岡原　智也</a></td>
                              <td>29</td>
                            </tr>
                          </tbody>
                        </table>
                        <div class="table_details">
                          <div class="numbers">
                            <p>1件〜10件</p>
                          </div>
                          <div class="pages" id="target_point">
                            <div>
                              <a>前へ&emsp;1&emsp;2&emsp;3&emsp;次へ</a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="msg-contents">
                    <div class="msg-topinner">
                      <div class="top-leftinner">
                        <p><img src="image/point.svg" alt="アイコン"/><span><a class="underline">上記氏名</a>をクリックすると詳細情報を確認できます</span></p>
                      </div>
                    </div>
                    <div class="msg-bottominner">
                      <div class="explanation_list">
                        <ul>
                          <div class="text-container1">
                            <div class="text-container1-left">
                              <p>（※1）</p>
                            </div>
                            <div class="text-container1-right">
                              <p>テキストテキスト</p>
                            </div>
                          </div>

                          <div class="text-container1">
                            <div class="text-container1-left">
                              <p>（※2）</p>
                            </div>
                            <div class="text-container1-right">
                              <p>テキストテキスト</p>
                            </div>
                          </div>

                          <div class="text-container1">
                            <div class="text-container1-left">
                              <p>（※3）</p>
                            </div>
                            <div class="text-container1-right">
                              <p>テキストテキスト</p>
                            </div>
                          </div>

                          <div class="text-container1">
                            <div class="text-container1-left">
                              <p>（※4）</p>
                            </div>
                            <div class="text-container1-right">
                              <p>テキストテキスト</p>
                            </div>
                          </div>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div id="personal_tab_three_inner" class="tab_inner">
              <div class="chart_container_left">
                <div class="subtitle-contents">
                  <div class="subtitle_leftinner">
                    <div class="subtitle_name">
                      <p>ページ別アクセス数【トップ50】</p>
                    </div>
                  </div>
                </div>
                <div class="context">
                  <div class="table-contents">
                    <div class="table-rightinner">
                      <div class="table">
                        <table>
                          <thead>
                            <tr>
                              <th>ページ名<img src="image/sort.svg" alt="アイコン"/></th>
                              <th>カテゴリ名<img src="image/sort.svg" alt="アイコン"/></th>
                              <th>階層<img src="image/sort.svg" alt="アイコン"/></th>
                              <th>アクセス数<img src="image/sort.svg" alt="アイコン"/></th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td>1</td>
                              <td>4251</td>
                            </tr>
                            <tr>
                              <td class="long_text"><a class="openDetails">DDS生体認証ソリューション</a></td>
                              <td class="long_text"><a class="openDetails">DDS生体認証ソリューション</a></td>
                              <td>3</td>
                              <td>222</td>
                            </tr>
                            <tr>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td>1</td>
                              <td>4251</td>
                            </tr>
                            <tr>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td>1</td>
                              <td>4251</td>
                            </tr>
                            <tr>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td>1</td>
                              <td>4251</td>
                            </tr>
                            <tr>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td>1</td>
                              <td>4251</td>
                            </tr>
                            <tr>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td>1</td>
                              <td>4251</td>
                            </tr>
                            <tr>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td>1</td>
                              <td>4251</td>
                            </tr>
                            <tr>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td>1</td>
                              <td>4251</td>
                            </tr>
                            <tr>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td class="long_text"><a class="openDetails">トップページ</a></td>
                              <td>1</td>
                              <td>4251</td>
                            </tr>
                          </tbody>
                        </table>
                        <div class="table_details">
                          <div class="numbers">
                            <p>1件〜10件</p>
                          </div>
                          <div class="pages" id="target_point">
                            <div>
                              <a>前へ&emsp;1&emsp;2&emsp;3&emsp;次へ</a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="msg-contents">
                  <div class="msg-topinner">
                    <div class="top-leftinner">
                      <p><img src="image/point.svg" alt="アイコン"/><span><a class="underline">上記ページ名またはカテゴリ名</a>をクリックすると詳細情報を確認できます</span></p>
                    </div>
                  </div>
                  <div class="msg-bottominner">
                    <div class="explanation_list">
                      <ul>
                        <div class="text-container1">
                          <div class="text-container1-left">
                            <p>（※1）</p>
                          </div>
                          <div class="text-container1-right">
                            <p>テキストテキスト</p>
                          </div>
                        </div>

                        <div class="text-container1">
                          <div class="text-container1-left">
                            <p>（※2）</p>
                          </div>
                          <div class="text-container1-right">
                            <p>テキストテキスト</p>
                          </div>
                        </div>

                        <div class="text-container1">
                          <div class="text-container1-left">
                            <p>（※3）</p>
                          </div>
                          <div class="text-container1-right">
                            <p>テキストテキスト</p>
                          </div>
                        </div>

                        <div class="text-container1">
                          <div class="text-container1-left">
                            <p>（※4）</p>
                          </div>
                          <div class="text-container1-right">
                            <p>テキストテキスト</p>
                          </div>
                        </div>
                      </ul>
                    </div>
                  </div>
                </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script>
        // ページ遷移した際、画面トップではなく「来訪した企業・団体名とアクセス数エリア」の表が表示される
        $(function () {
          var result = location.href;
          if (result.includes("PageNum_company")){
            	$('html,body').scrollTop(210);
          };
        });

        //////////////////////////////// 開封率グラフ
        var resizeObject=document.getElementById("lineChart");
        resizeObject.width=window.innerWidth*0.1;
        resizeObject.height=window.innerHeight*0.08;

        Chart.defaults.global.legend.display = false;
        var ctx = document.getElementById('lineChart').getContext('2d');
        var barChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
                datasets: [{
                    label: '# of Votes',
                    data: [1252, 1584, 2158, 2412, 3581, 5581],
                    backgroundColor: "rgb(163, 0, 38)",
                }]
            },
            options: {
                scales: {
                  xAxes: [{
                    categoryPercentage: 0.6,
                    ticks: {
                      maxRotation: 0,
                      minRotation: 0,
                    }
                  }],
                  yAxes: [{
                      ticks: {
                        beginAtZero: true,
                        min: 0,
                        userCallback: function(label, index, labels) {
                          if (Math.floor(label) === label) {
                            return label;
                          }
                        }
                      }
                  }]
                },
                tooltips:{
                  callbacks:
                  {
                      label: function(tooltipItems, data) {
                          if(tooltipItems.yLabel == "0"){
                              return "";
                          }
                          return tooltipItems.yLabel;
                      }
                  }
                }
            }
        });

        //////////////////////////////// クリック率グラフ
        let piechartElement=document.getElementById("pieChart");
        piechartElement.width=window.innerWidth*0.1;

        let agent = window.navigator.userAgent.toLowerCase();
         if(agent.indexOf('edge') > -1) {
           piechartElement.height=window.innerHeight*0.09;
         } else {
           piechartElement.height=window.innerHeight*0.06;
         }

        var aol = document.getElementById('pieChart');
        var pieChart = new Chart(aol, {
            type: 'pie',
            data: {
              labels: ['丁稚どんメルマガ2019年7月号', '新ものづくり展「ASPACクラウド生産管理」来場御礼メール', '本格的生産管理システムセミナーご案内！', '（再送）クラウドサービス利用率向上してます！', '丁稚どんメルマガ2019年7月号', '丁稚どんメルマガ2019年7月号', '丁稚どんメルマガ2019年7月号', '丁稚どんメルマガ2019年7月号', '丁稚どんメルマガ2019年7月号', '丁稚どんメルマガ2019年7月号'],
              datasets: [{
                  label: 'percentage',
                  data: [11, 9, 28, 5, 1, 2, 4, 20, 6, 2],
                  backgroundColor: ["#f8dcdc", "#f1b8b8", "#ea9595", "#e27272", "#dc4e4e", "#d52b2b", "#b12323", "#8d1d1d", "#6a1515", "#470e0e"],
                  borderWidth: "1px",
              }]
            },
            options: {
              tooltips: {
                callbacks: {
                  label: function (tooltipItem, data) {
                    return data.labels[tooltipItem.index]
                      + " : "
                      + data.datasets[0].data[tooltipItem.index]
                      + "%"; //ここで単位を付けます
                  }
                }
              }
            }
        });

        function tabManageContents(selectedTab) {
          let tabs = document.getElementById( "tabManagement" );
          let tabInners = document.getElementById( "tabInners" );
        // let allTabs = Array.from(tabs.children); not supported in IE
          let allTabs = [];
          for (i = 0; i < tabs.children.length; i++) {
            allTabs.push( tabs.children[i] ) ;
          }

          let allTabInners = [];
          for (i = 0; i < tabInners.children.length; i++) {
            allTabs.push( tabInners.children[i] ) ;
          }

          let targetTab = selectedTab;
          let targetTabInner = document.getElementById( selectedTab.id + "_inner" );

          addClassOnSelectedElement(allTabs, selectedTab);
          addClassOnSelectedElement(allTabInners, targetTabInner);

        //クリックされた要素をarrayから削除する
              function addClassOnSelectedElement(allElements, selectedElement) {
                allElements.some(function(v, n){
                  if (v==selectedElement) allElements.splice(n,1);
                });

                for (i = 0; i < allElements.length; i++) {
                  if($(allElements[i]).hasClass('clicked')) {
                    $(allElements[i]).removeClass('clicked');
                  }
                }
                $(selectedElement).addClass('clicked');
              }

        };

        if(!agent.indexOf('edge') > -1) {
          changeFontSize = document.getElementsByClassName("changeFontSize");
          console.log(changeFontSize);
          for (i = 0; i < changeFontSize.length; i++) {
            $(changeFontSize[i]).css("font-size", "11px");
          }
        };

      </script>
    </div>

    <script src="js/jquery-3.3.1.min.js"></script>
  </body>
</html>
